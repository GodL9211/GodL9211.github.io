import{_ as n}from"./plugin-vue_export-helper-c27b6911.js";import{o as s,c as a,f as p}from"./app-61908888.js";const e="/assets/image_BQ4yODnMC8-cfb42c91.png",t="/assets/image_5GtjwmQnHz-75999ef2.png",o="/assets/image_lBFF5CsbHq-19d3addb.png",c="/assets/image_7iHKp7GvKN-03d72692.png",l="/assets/image_2b0Z9Tw_Ui-640b9c53.png",k={},u=p(`<h1 id="_50道sql经典面试题-上" tabindex="-1"><a class="header-anchor" href="#_50道sql经典面试题-上" aria-hidden="true">#</a> 50道SQL经典面试题(上)</h1><p>原创 丶平凡世界</p><p>最近在收集SQL每日一题时，找到这套比较经典的SQL面试题。 </p><p>我根据题目重新梳理了一遍，包括表结构，表之间的关系，测试数据，题目，参考答案等。其中大部分参考答案在各种数据库平台上通用。 </p><p>由于题目数量较多（足足50道题），小伙伴们可能不容易消化理解，于是将内容分为上下两篇，希望对你有所帮助。</p><p><strong>一、表结构</strong></p><p>1、学生表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>Student<span class="token punctuation">(</span>Sid<span class="token punctuation">,</span>Sname<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>Ssex<span class="token punctuation">)</span>
学生编号，学生姓名，出生年月，学生性别
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2、课程表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>Course<span class="token punctuation">(</span>Cid<span class="token punctuation">,</span>Cname<span class="token punctuation">,</span>Tid<span class="token punctuation">)</span> 
课程编号，课程名称，教师编号
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>3、教师表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>Teacher<span class="token punctuation">(</span>Tid<span class="token punctuation">,</span>Tname<span class="token punctuation">)</span>
教师编号，教师姓名
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>4、成绩表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>SC<span class="token punctuation">(</span>Sid<span class="token punctuation">,</span>Cid<span class="token punctuation">,</span>Score<span class="token punctuation">)</span>
学生编号，课程编号，分数
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>二、表之间的关系</strong></p><p>四张表之间的关系如下图：</p><figure><img src="`+e+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>我们来解读一下上面的关系： </p><p>1、课程表Course的课程编号(Cid)作为主键，在成绩表(SC)中可以看到一个或多个学生的课程分数，两表之间是属于<code>1：n</code>的关系。同理学生表(Student)与成绩表(SC)也是<code>1：n</code>的关系</p><p>2、教师表Teacher的教师编号(Tid)作为主键，在课程表(Course)中可以带一门或多门课程，两表之间也是属于1：n的关系。</p><p><strong>三、测试数据</strong></p><p>1、学生表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Student <span class="token punctuation">(</span>
  SID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Sname nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Sage <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  Ssex nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;赵雷&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-01-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;钱电&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-12-21&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;孙风&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-05-20&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;李云&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-08-06&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;05&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;周梅&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1991-12-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;06&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;吴兰&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1992-03-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;07&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;郑竹&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1989-07-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;08&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;王菊&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-01-20&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下：</p><figure><img src="`+t+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>2、课程表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Course <span class="token punctuation">(</span>
  CID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Cname nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  TID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;语文&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;数学&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;英语&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下： </p><figure><img src="`+o+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>3、教师表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Teacher <span class="token punctuation">(</span>
  TID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Tname nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;张三&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;李四&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;王五&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下： </p><figure><img src="`+c+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>4、成绩表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> SC <span class="token punctuation">(</span>
  SID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  CID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  score <span class="token keyword">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;05&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;05&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;06&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;06&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;07&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;07&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下： </p><figure><img src="`+l+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>四、面试题及参考答案</strong></p><p>1、查询&quot; 01 &quot;课程比&quot; 02&quot;课程成绩高的学生的信息及课程分数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--方法一</span>
<span class="token keyword">SELECT</span>  a<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span>  Student a
<span class="token keyword">JOIN</span> SC b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>SID <span class="token operator">=</span> b<span class="token punctuation">.</span>SID
<span class="token keyword">JOIN</span> sc c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>SID <span class="token operator">=</span> c<span class="token punctuation">.</span>SID
<span class="token keyword">WHERE</span>  b<span class="token punctuation">.</span>Cid <span class="token operator">=</span> <span class="token string">&#39;01&#39;</span>
<span class="token operator">AND</span> c<span class="token punctuation">.</span>Cid <span class="token operator">=</span> <span class="token string">&#39;02&#39;</span>
<span class="token operator">AND</span> b<span class="token punctuation">.</span>Score <span class="token operator">&gt;</span> c<span class="token punctuation">.</span>Score

<span class="token comment">--方法二</span>
<span class="token keyword">SELECT</span>  A<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span> B<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> Student A
<span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;01&#39;</span><span class="token punctuation">)</span> B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID <span class="token operator">=</span> B<span class="token punctuation">.</span>SID
<span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;02&#39;</span><span class="token punctuation">)</span> C <span class="token keyword">ON</span> C<span class="token punctuation">.</span>SID <span class="token operator">=</span> B<span class="token punctuation">.</span>SID
<span class="token keyword">WHERE</span>  B<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> C<span class="token punctuation">.</span>score
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2、查询同时存在&quot; 01 &quot;课程和&quot;02 &quot;课程的情况</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--方法一</span>
<span class="token keyword">SELECT</span>
  A<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> Student A
<span class="token keyword">JOIN</span> SC B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
<span class="token keyword">JOIN</span> SC C <span class="token keyword">ON</span> C<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
<span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>CID<span class="token operator">=</span><span class="token string">&#39;01&#39;</span>
<span class="token operator">AND</span> C<span class="token punctuation">.</span>CID<span class="token operator">=</span><span class="token string">&#39;02&#39;</span>

<span class="token comment">--方法二</span>
<span class="token keyword">SELECT</span>
  A<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> Student A
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;01&#39;</span><span class="token punctuation">)</span> B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
<span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;02&#39;</span><span class="token punctuation">)</span> C <span class="token keyword">ON</span> B<span class="token punctuation">.</span>SID <span class="token operator">=</span> C<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3、查询存在&quot; 01 &quot;课程但可能不存在&quot;02 &quot;课程的情况(不存在时显示为 null )</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  <span class="token operator">*</span>
<span class="token keyword">FROM</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;01&#39;</span><span class="token punctuation">)</span> A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;02&#39;</span><span class="token punctuation">)</span> B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID <span class="token operator">=</span> B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4、查询不存在&quot; 01 &quot;课程但存在&quot;02 &quot;课程的情况</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  <span class="token operator">*</span>
<span class="token keyword">FROM</span>  SC
<span class="token keyword">WHERE</span>  CID <span class="token operator">=</span> <span class="token string">&#39;02&#39;</span>
<span class="token operator">AND</span> SID <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>  SID <span class="token keyword">FROM</span> SC
  <span class="token keyword">WHERE</span> CID <span class="token operator">=</span> <span class="token string">&#39;01&#39;</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>
  B<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>
  A<span class="token punctuation">.</span>dc
<span class="token keyword">FROM</span>
  <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  SID<span class="token punctuation">,</span><span class="token function">AVG</span> <span class="token punctuation">(</span>score<span class="token punctuation">)</span> dc
    <span class="token keyword">FROM</span>  SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  SID
    <span class="token keyword">HAVING</span> <span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">60</span>
  <span class="token punctuation">)</span> A
<span class="token keyword">JOIN</span> Student B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID <span class="token operator">=</span> B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6、查询在 SC 表存在成绩的学生信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  <span class="token operator">*</span>
<span class="token keyword">FROM</span>
  Student
<span class="token keyword">WHERE</span>
  SID <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> SID <span class="token keyword">FROM</span> SC<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>7、查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩(没成绩的显示为 null )</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>
  A<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>
  B<span class="token punctuation">.</span>Cnt<span class="token punctuation">,</span>
  B<span class="token punctuation">.</span>Total
<span class="token keyword">FROM</span> Student A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>
      SID<span class="token punctuation">,</span>
      <span class="token function">COUNT</span> <span class="token punctuation">(</span>CID<span class="token punctuation">)</span> Cnt<span class="token punctuation">,</span>
      <span class="token function">SUM</span> <span class="token punctuation">(</span>score<span class="token punctuation">)</span> Total
    <span class="token keyword">FROM</span>  SC
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
  <span class="token punctuation">)</span> B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID <span class="token operator">=</span> B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>8、查有成绩的学生信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>
  A<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>
  B<span class="token punctuation">.</span>Cnt<span class="token punctuation">,</span>
  B<span class="token punctuation">.</span>Total
<span class="token keyword">FROM</span> Student A
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>
      SID<span class="token punctuation">,</span>
      <span class="token function">COUNT</span> <span class="token punctuation">(</span>CID<span class="token punctuation">)</span> Cnt<span class="token punctuation">,</span>
      <span class="token function">SUM</span> <span class="token punctuation">(</span>score<span class="token punctuation">)</span> Total
    <span class="token keyword">FROM</span>  SC
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
  <span class="token punctuation">)</span> B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID <span class="token operator">=</span> B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>9、查询「李」姓老师的数量 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  <span class="token function">COUNT</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 李姓老师数量
<span class="token keyword">FROM</span>  Teacher
<span class="token keyword">WHERE</span>  Tname <span class="token operator">LIKE</span> <span class="token string">&#39;李%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>10、查询学过「张三」老师授课的同学的信息 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> SID <span class="token operator">IN</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">DISTINCT</span> SID <span class="token keyword">FROM</span> SC a
<span class="token keyword">JOIN</span> Course b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>cid<span class="token operator">=</span>b<span class="token punctuation">.</span>cid
<span class="token keyword">JOIN</span> Teacher c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>Tid<span class="token operator">=</span>c<span class="token punctuation">.</span>Tid
<span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>Tname<span class="token operator">=</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>11、查询没有学全所有课程的同学的信息 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  <span class="token operator">*</span> <span class="token keyword">FROM</span>  Student
<span class="token keyword">WHERE</span>  SID <span class="token operator">IN</span> 
<span class="token punctuation">(</span>
<span class="token keyword">SELECT</span>  SID  <span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>  SID
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span> <span class="token punctuation">(</span>CID<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>12、查询至少有一门课与学号为&quot; 01 &quot;的同学所学相同的同学的信息 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>  <span class="token operator">*</span>
<span class="token keyword">FROM</span>  Student
<span class="token keyword">WHERE</span>  SID <span class="token operator">IN</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>  SID
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span>  CID <span class="token operator">IN</span> 
<span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> CID
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> SID <span class="token operator">=</span> <span class="token string">&#39;01&#39;</span>
 <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>13、查询和&quot; 01 &quot;号的同学学习的课程完全相同的其他同学的信息 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> SID <span class="token operator">in</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> SID <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CID <span class="token operator">in</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> CID <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> SID<span class="token operator">=</span><span class="token string">&#39;01&#39;</span><span class="token punctuation">)</span> <span class="token operator">and</span> SID<span class="token operator">&lt;&gt;</span><span class="token string">&#39;01&#39;</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
<span class="token keyword">having</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>CID<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>14、查询没学过&quot;张三&quot;老师讲授的任一门课程的学生姓名 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> SID <span class="token operator">NOT</span> <span class="token operator">IN</span> 
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">DISTINCT</span> SID <span class="token keyword">FROM</span> SC a
<span class="token keyword">JOIN</span> Course b <span class="token keyword">ON</span> a<span class="token punctuation">.</span>cid<span class="token operator">=</span>b<span class="token punctuation">.</span>cid
<span class="token keyword">JOIN</span> Teacher c <span class="token keyword">ON</span> b<span class="token punctuation">.</span>Tid<span class="token operator">=</span>c<span class="token punctuation">.</span>Tid
<span class="token keyword">WHERE</span> c<span class="token punctuation">.</span>Tname<span class="token operator">=</span><span class="token string">&#39;张三&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>15、查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>A<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>B<span class="token punctuation">.</span>平均成绩
<span class="token keyword">FROM</span> Student A
<span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>平均成绩 <span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> score<span class="token operator">&lt;</span><span class="token number">60</span> 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID 
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">2</span>
<span class="token punctuation">)</span>B
<span class="token keyword">on</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>16、检索&quot; 01 &quot;课程分数小于 60，按分数降序排列的学生信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>B<span class="token punctuation">.</span>score <span class="token keyword">FROM</span> 
Student A
<span class="token keyword">JOIN</span> SC B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
<span class="token keyword">WHERE</span> CID<span class="token operator">=</span><span class="token string">&#39;01&#39;</span> <span class="token operator">AND</span> Score<span class="token operator">&lt;</span><span class="token number">60</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>17、按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span>
<span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">case</span> CID <span class="token keyword">when</span> <span class="token string">&#39;01&#39;</span> <span class="token keyword">then</span> score <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token string">&#39;01&#39;</span><span class="token punctuation">,</span>
<span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">case</span> CID <span class="token keyword">when</span> <span class="token string">&#39;02&#39;</span> <span class="token keyword">then</span> score <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token string">&#39;02&#39;</span><span class="token punctuation">,</span>
<span class="token function">MAX</span><span class="token punctuation">(</span><span class="token keyword">case</span> CID <span class="token keyword">when</span> <span class="token string">&#39;03&#39;</span> <span class="token keyword">then</span> score <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token string">&#39;03&#39;</span><span class="token punctuation">,</span>
<span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>平均分 <span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 平均分 <span class="token keyword">DESC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>18、查询各科成绩最高分、最低分和平均分：</p><p>以如下形式显示：课程 ID，课程 name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率 </p><p>及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--SQL Server的解法</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> A<span class="token punctuation">.</span>CID<span class="token punctuation">,</span>Cname<span class="token punctuation">,</span>最高分<span class="token punctuation">,</span>最低分<span class="token punctuation">,</span>平均分<span class="token punctuation">,</span>及格率<span class="token punctuation">,</span>中等率<span class="token punctuation">,</span>优良率<span class="token punctuation">,</span>优秀率 <span class="token keyword">FROM</span> SC A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Course <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>Course<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>最高分<span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>最低分<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>平均分 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>B <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>B<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;=</span><span class="token number">60</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span>及格率 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>C <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>C<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score <span class="token operator">&gt;=</span><span class="token number">70</span> <span class="token operator">and</span> score<span class="token operator">&lt;</span><span class="token number">80</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span>中等率 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>D <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>D<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score <span class="token operator">&gt;=</span><span class="token number">80</span> <span class="token operator">and</span> score<span class="token operator">&lt;</span><span class="token number">90</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span>优良率 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>E <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>E<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score <span class="token operator">&gt;=</span><span class="token number">90</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span>优秀率
<span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>F <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>F<span class="token punctuation">.</span>CID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>（提示：可以左右滑动代码）</p><p>19、按各科成绩进行排序，并显示排名， Score 重复时保留名次空缺</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>RANK<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> 排名 <span class="token keyword">FROM</span> SC
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>20 按各科成绩进行排序，并显示排名， Score 重复时合并名次</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> 排名 <span class="token keyword">FROM</span> SC
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>21、查询学生的总成绩，并进行排名，总分重复时保留名次空缺</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>RANK<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> 总成绩 <span class="token keyword">desc</span><span class="token punctuation">)</span> 排名
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 总成绩 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
<span class="token punctuation">)</span>A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>22 、查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">over</span><span class="token punctuation">(</span><span class="token keyword">order</span> <span class="token keyword">by</span> 总成绩 <span class="token keyword">desc</span><span class="token punctuation">)</span> 排名
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>总成绩 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
<span class="token punctuation">)</span>A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>23、统计各科成绩各分数段人数：课程编号，课程名称，[100-85]，[85-70]，[70-60]，[60-0] 及所占百分比</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> A<span class="token punctuation">.</span>CID<span class="token punctuation">,</span>B<span class="token punctuation">.</span>Cname<span class="token punctuation">,</span>C<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token operator">-</span><span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">,</span>C<span class="token punctuation">.</span>所占百分比<span class="token punctuation">,</span>D<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">85</span><span class="token operator">-</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span>D<span class="token punctuation">.</span>所占百分比<span class="token punctuation">,</span>E<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">70</span><span class="token operator">-</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>E<span class="token punctuation">.</span>所占百分比<span class="token punctuation">,</span>F<span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>F<span class="token punctuation">.</span>所占百分比
<span class="token keyword">FROM</span> SC A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Course B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>B<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">85</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token operator">-</span><span class="token number">85</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">85</span> <span class="token operator">and</span> score<span class="token operator">&lt;</span><span class="token number">100</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> 所占百分比 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>C <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>C<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">70</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">85</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">85</span><span class="token operator">-</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">70</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">85</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> 所占百分比 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>D <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>D<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">60</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">70</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">70</span><span class="token operator">-</span><span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">60</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">70</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> 所占百分比 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>E <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>E<span class="token punctuation">.</span>CID
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">60</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token keyword">convert</span><span class="token punctuation">(</span><span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">case</span> <span class="token keyword">when</span> score<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token operator">and</span> score<span class="token operator">&lt;=</span><span class="token number">60</span> <span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">null</span> <span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.00</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> 所占百分比 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID<span class="token punctuation">)</span>F <span class="token keyword">on</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>F<span class="token punctuation">.</span>CID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>24、查询各科成绩前三名的记录</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> CID <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span><span class="token punctuation">)</span> A
<span class="token keyword">FROM</span> SC<span class="token punctuation">)</span>B
<span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>A<span class="token operator">&lt;=</span><span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>25、查询每门课程被选修的学生数 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>SID<span class="token punctuation">)</span>学生数 <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,91),i=[u];function r(d,v){return s(),a("div",null,i)}const y=n(k,[["render",r],["__file","50道SQL经典面试题(上).html.vue"]]);export{y as default};
