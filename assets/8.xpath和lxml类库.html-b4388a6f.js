import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as o,o as l,c as i,a as n,b as s,e as t,f as e}from"./app-9976b6d0.js";const c="data:image/gif;base64,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",r="/assets/xpath-806d745c.png",u={},d=n("p",null,"有同学说，我正则用的不好，处理HTML文档很累，有没有其他的方法？",-1),k=n("p",null,"有！那就是XPath，我们可以先将 HTML文件 转换成 XML文档，然后用 XPath语法 查找 HTML 节点或元素。",-1),m=n("p",null,[s("什么是XML"),n("br"),s(" XML 指可扩展标记语言（EXtensible Markup Language）"),n("br"),s(" XML 是一种标记语言，很类似 HTML"),n("br"),s(" XML 的设计宗旨是传输数据，而非显示数据"),n("br"),s(" XML 的标签需要我们自行定义。"),n("br"),s(" XML 被设计为具有自我描述性。"),n("br"),s(" XML 是 W3C 的推荐标准")],-1),v={href:"http://www.w3school.com.cn/xml/index.asp",target:"_blank",rel:"noopener noreferrer"},g=e(`<h2 id="xml-和-html-的区别" tabindex="-1"><a class="header-anchor" href="#xml-和-html-的区别" aria-hidden="true">#</a> XML 和 HTML 的区别</h2><table><thead><tr><th>数据格式</th><th style="text-align:center;">描述</th><th>设计目标</th></tr></thead><tbody><tr><td>XML</td><td style="text-align:center;">Extensible Markup Language <code>（可扩展标记语言）</code></td><td>被设计为传输和存储数据，其焦点是数据的内容。</td></tr><tr><td>HTML</td><td style="text-align:center;">HyperText Markup Language <code>（超文本标记语言）</code></td><td>显示数据以及如何更好显示数据。</td></tr><tr><td>HTML DOM</td><td style="text-align:center;">Document Object Model for HTML <code>(文档对象模型)</code></td><td>通过 HTML DOM，可以访问所有的 HTML 元素，连同它们所包含的文本和属性。可以对其中的内容进行修改和删除，同时也可以创建新的元素。</td></tr></tbody></table><h3 id="xml文档示例" tabindex="-1"><a class="header-anchor" href="#xml文档示例" aria-hidden="true">#</a> XML文档示例</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token operator">&lt;</span>?xml version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span>?<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>bookstore<span class="token operator">&gt;</span> 

  <span class="token operator">&lt;</span>book category<span class="token operator">=</span><span class="token string">&quot;cooking&quot;</span><span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span>title lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>Everyday Italian<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>Giada De Laurentiis<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>year<span class="token operator">&gt;</span><span class="token number">2005</span><span class="token operator">&lt;</span><span class="token operator">/</span>year<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>price<span class="token operator">&gt;</span><span class="token number">30.00</span><span class="token operator">&lt;</span><span class="token operator">/</span>price<span class="token operator">&gt;</span> 
  <span class="token operator">&lt;</span><span class="token operator">/</span>book<span class="token operator">&gt;</span>  

  <span class="token operator">&lt;</span>book category<span class="token operator">=</span><span class="token string">&quot;children&quot;</span><span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span>title lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>Harry Potter<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>J K<span class="token punctuation">.</span> Rowling<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>year<span class="token operator">&gt;</span><span class="token number">2005</span><span class="token operator">&lt;</span><span class="token operator">/</span>year<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>price<span class="token operator">&gt;</span><span class="token number">29.99</span><span class="token operator">&lt;</span><span class="token operator">/</span>price<span class="token operator">&gt;</span> 
  <span class="token operator">&lt;</span><span class="token operator">/</span>book<span class="token operator">&gt;</span>  

  <span class="token operator">&lt;</span>book category<span class="token operator">=</span><span class="token string">&quot;web&quot;</span><span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span>title lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>XQuery Kick Start<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>James McGovern<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>Per Bothner<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>Kurt Cagle<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>James Linn<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>Vaidyanathan Nagarajan<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>year<span class="token operator">&gt;</span><span class="token number">2003</span><span class="token operator">&lt;</span><span class="token operator">/</span>year<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>price<span class="token operator">&gt;</span><span class="token number">49.99</span><span class="token operator">&lt;</span><span class="token operator">/</span>price<span class="token operator">&gt;</span> 
  <span class="token operator">&lt;</span><span class="token operator">/</span>book<span class="token operator">&gt;</span> 

  <span class="token operator">&lt;</span>book category<span class="token operator">=</span><span class="token string">&quot;web&quot;</span> cover<span class="token operator">=</span><span class="token string">&quot;paperback&quot;</span><span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span>title lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>Learning XML<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>author<span class="token operator">&gt;</span>Erik T<span class="token punctuation">.</span> Ray<span class="token operator">&lt;</span><span class="token operator">/</span>author<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>year<span class="token operator">&gt;</span><span class="token number">2003</span><span class="token operator">&lt;</span><span class="token operator">/</span>year<span class="token operator">&gt;</span>  
    <span class="token operator">&lt;</span>price<span class="token operator">&gt;</span><span class="token number">39.95</span><span class="token operator">&lt;</span><span class="token operator">/</span>price<span class="token operator">&gt;</span> 
  <span class="token operator">&lt;</span><span class="token operator">/</span>book<span class="token operator">&gt;</span> 

<span class="token operator">&lt;</span><span class="token operator">/</span>bookstore<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="html-dom-模型示例" tabindex="-1"><a class="header-anchor" href="#html-dom-模型示例" aria-hidden="true">#</a> HTML DOM 模型示例</h3><p>HTML DOM 定义了访问和操作 HTML 文档的标准方法，以树结构方式表达 HTML 文档。</p><figure><img src="`+c+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="xml的节点关系" tabindex="-1"><a class="header-anchor" href="#xml的节点关系" aria-hidden="true">#</a> XML的节点关系</h2><h3 id="_1-父-parent" tabindex="-1"><a class="header-anchor" href="#_1-父-parent" aria-hidden="true">#</a> 1. 父（Parent）</h3><p>每个元素以及属性都有一个父。</p><p>下面是一个简单的XML例子中，book 元素是 title、author、year 以及 price 元素的父：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Harry Potter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>J K. Rowling<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">&gt;</span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>29.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-子-children" tabindex="-1"><a class="header-anchor" href="#_2-子-children" aria-hidden="true">#</a> 2. 子（Children）</h3><p>元素节点可有零个、一个或多个子。</p><p>在下面的例子中，title、author、year 以及 price 元素都是 book 元素的子：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Harry Potter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>J K. Rowling<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">&gt;</span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>29.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-同胞-sibling" tabindex="-1"><a class="header-anchor" href="#_3-同胞-sibling" aria-hidden="true">#</a> 3. 同胞（Sibling）</h3><p>拥有相同的父的节点</p><p>在下面的例子中，title、author、year 以及 price 元素都是同胞：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Harry Potter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>J K. Rowling<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">&gt;</span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>29.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-先辈-ancestor" tabindex="-1"><a class="header-anchor" href="#_4-先辈-ancestor" aria-hidden="true">#</a> 4. 先辈（Ancestor）</h3><p>某节点的父、父的父，等等。</p><p>在下面的例子中，title 元素的先辈是 book 元素和 bookstore 元素：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bookstore</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Harry Potter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>J K. Rowling<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">&gt;</span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>29.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bookstore</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-后代-descendant" tabindex="-1"><a class="header-anchor" href="#_5-后代-descendant" aria-hidden="true">#</a> 5. 后代（Descendant）</h3><p>某个节点的子，子的子，等等。</p><p>在下面的例子中，bookstore 的后代是 book、title、author、year 以及 price 元素：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bookstore</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>book</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Harry Potter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">&gt;</span></span>J K. Rowling<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>year</span><span class="token punctuation">&gt;</span></span>2005<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>year</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>price</span><span class="token punctuation">&gt;</span></span>29.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>price</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>book</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bookstore</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="什么是xpath" tabindex="-1"><a class="header-anchor" href="#什么是xpath" aria-hidden="true">#</a> 什么是XPath？</h2>`,29),b=n("p",null,"XPath (XML Path Language) 是一门在 XML 文档中查找信息的语言，可用来在 XML 文档中对元素和属性进行遍历。",-1),h={href:"http://www.w3school.com.cn/xpath/index.asp",target:"_blank",rel:"noopener noreferrer"},y=e('<h3 id="xpath-开发工具" tabindex="-1"><a class="header-anchor" href="#xpath-开发工具" aria-hidden="true">#</a> XPath 开发工具</h3><ol><li>开源的XPath表达式编辑工具:XMLQuire(XML格式文件可用)</li><li>Chrome插件 XPath Helper</li><li>Firefox插件 XPath Checker</li></ol><h3 id="选取节点" tabindex="-1"><a class="header-anchor" href="#选取节点" aria-hidden="true">#</a> 选取节点</h3><p>XPath 使用路径表达式来选取 XML 文档中的节点或者节点集。这些路径表达式和我们在常规的电脑文件系统中看到的表达式非常相似。</p><p>下面列出了最常用的路径表达式：</p><table><thead><tr><th>表达式</th><th>描述</th></tr></thead><tbody><tr><td>nodename</td><td>选取此节点的所有子节点。</td></tr><tr><td>/</td><td>从根节点选取。</td></tr><tr><td>//</td><td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</td></tr><tr><td>.</td><td>选取当前节点。</td></tr><tr><td>..</td><td>选取当前节点的父节点。</td></tr><tr><td>@</td><td>选取属性。</td></tr></tbody></table><p>在下面的表格中，我们已列出了一些路径表达式以及表达式的结果：</p><table><thead><tr><th>路径表达式</th><th>结果</th></tr></thead><tbody><tr><td>bookstore</td><td>选取 bookstore 元素的所有子节点。</td></tr><tr><td>/bookstore</td><td>选取根元素 bookstore。注释：假如路径起始于正斜杠( / )，则此路径始终代表到某元素的绝对路径！</td></tr><tr><td>bookstore/book</td><td>选取属于 bookstore 的子元素的所有 book 元素。</td></tr><tr><td>//book</td><td>选取所有 book 子元素，而不管它们在文档中的位置。</td></tr><tr><td>bookstore//book</td><td>选择属于 bookstore 元素的后代的所有 book 元素，而不管它们位于 bookstore 之下的什么位置。</td></tr><tr><td>//@lang</td><td>选取名为 lang 的所有属性。</td></tr></tbody></table><h3 id="谓语-predicates" tabindex="-1"><a class="header-anchor" href="#谓语-predicates" aria-hidden="true">#</a> 谓语（Predicates）</h3><p>谓语用来查找某个特定的节点或者包含某个指定的值的节点，被嵌在方括号中。</p><p>在下面的表格中，我们列出了带有谓语的一些路径表达式，以及表达式的结果：</p><table><thead><tr><th>路径表达式</th><th>结果</th></tr></thead><tbody><tr><td>/bookstore/book[1]</td><td>选取属于 bookstore 子元素的第一个 book 元素。</td></tr><tr><td>/bookstore/book[last()]</td><td>选取属于 bookstore 子元素的最后一个 book 元素。</td></tr><tr><td>/bookstore/book[last()-1]</td><td>选取属于 bookstore 子元素的倒数第二个 book 元素。</td></tr><tr><td>/bookstore/book[position()❤️]</td><td>选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</td></tr><tr><td>//title[@lang]</td><td>选取所有拥有名为 lang 的属性的 title 元素。</td></tr><tr><td>//title[@lang=’eng’]</td><td>选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</td></tr><tr><td>/bookstore/book[price&gt;35.00]</td><td>选取 bookstore 元素的所有 book 元素，且其中的 price 元素的值须大于 35.00。</td></tr><tr><td>/bookstore/book[price&gt;35.00]/title</td><td>选取 bookstore 元素中的 book 元素的所有 title 元素，且其中的 price 元素的值须大于 35.00。</td></tr></tbody></table><h3 id="选取未知节点" tabindex="-1"><a class="header-anchor" href="#选取未知节点" aria-hidden="true">#</a> 选取未知节点</h3><p>XPath 通配符可用来选取未知的 XML 元素。</p><table><thead><tr><th>通配符</th><th>描述</th></tr></thead><tbody><tr><td>*</td><td>匹配任何元素节点。</td></tr><tr><td>@*</td><td>匹配任何属性节点。</td></tr><tr><td>node()</td><td>匹配任何类型的节点。</td></tr></tbody></table><p>在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</p><table><thead><tr><th>路径表达式</th><th>结果</th></tr></thead><tbody><tr><td>/bookstore/*</td><td>选取 bookstore 元素的所有子元素。</td></tr><tr><td>//*</td><td>选取文档中的所有元素。</td></tr><tr><td>//title[@*]</td><td>选取所有带有属性的 title 元素。</td></tr></tbody></table><h3 id="选取若干路径" tabindex="-1"><a class="header-anchor" href="#选取若干路径" aria-hidden="true">#</a> 选取若干路径</h3><p>通过在路径表达式中使用“|”运算符，您可以选取若干个路径。</p><p>实例</p><p>在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</p><table><thead><tr><th>路径表达式</th><th>结果</th></tr></thead><tbody><tr><td>//book/title | //book/price</td><td>选取 book 元素的所有 title 和 price 元素。</td></tr><tr><td>//title | //price</td><td>选取文档中的所有 title 和 price 元素。</td></tr><tr><td>/bookstore/book/title | //price</td><td>选取属于 bookstore 元素的 book 元素的所有 title 元素，以及文档中所有的 price 元素。</td></tr></tbody></table><h3 id="xpath的运算符" tabindex="-1"><a class="header-anchor" href="#xpath的运算符" aria-hidden="true">#</a> XPath的运算符</h3><p>下面列出了可用在 XPath 表达式中的运算符：</p><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h5 id="这些就是xpath的语法内容-在运用到python抓取时要先转换为xml。" tabindex="-1"><a class="header-anchor" href="#这些就是xpath的语法内容-在运用到python抓取时要先转换为xml。" aria-hidden="true">#</a> 这些就是XPath的语法内容，在运用到Python抓取时要先转换为xml。</h5><h3 id="lxml库" tabindex="-1"><a class="header-anchor" href="#lxml库" aria-hidden="true">#</a> lxml库</h3>',27),f=n("p",null,"lxml 是 一个HTML/XML的解析器，主要的功能是如何解析和提取 HTML/XML 数据。",-1),x=n("p",null,"lxml和正则一样，也是用 C 实现的，是一款高性能的 Python HTML/XML 解析器，我们可以利用之前学习的XPath语法，来快速的定位特定元素以及节点信息。",-1),q={href:"http://lxml.de/index.html",target:"_blank",rel:"noopener noreferrer"},w=n("p",null,[s("需要安装C语言库，可使用 pip 安装："),n("code",null,"pip install lxml"),s(" （或通过wheel方式安装）")],-1),M=e(`<h3 id="初步使用" tabindex="-1"><a class="header-anchor" href="#初步使用" aria-hidden="true">#</a> 初步使用</h3><p>我们利用它来解析 HTML 代码，简单示例：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># lxml_test.py</span>

<span class="token comment"># 使用 lxml 的 etree 库</span>
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree 

text <span class="token operator">=</span> <span class="token triple-quoted-string string">&#39;&#39;&#39;
&lt;div&gt;
    &lt;ul&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;third item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt; # 注意，此处缺少一个 &lt;/li&gt; 闭合标签
     &lt;/ul&gt;
 &lt;/div&gt;
&#39;&#39;&#39;</span>

<span class="token comment">#利用etree.HTML，将字符串解析为HTML文档</span>
html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>text<span class="token punctuation">)</span> 

<span class="token comment"># 按字符串序列化HTML文档</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>html<span class="token punctuation">)</span> 

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出结果：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>li <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;item-0&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;link1.html&quot;</span><span class="token operator">&gt;</span>first item<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>li <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;item-1&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;link2.html&quot;</span><span class="token operator">&gt;</span>second item<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>li <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;item-inactive&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;link3.html&quot;</span><span class="token operator">&gt;</span>third item<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>li <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;item-1&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;link4.html&quot;</span><span class="token operator">&gt;</span>fourth item<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>li <span class="token assign-left variable">class</span><span class="token operator">=</span><span class="token string">&quot;item-0&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">&quot;link5.html&quot;</span><span class="token operator">&gt;</span>fifth item<span class="token operator">&lt;</span>/a<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/li<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/ul<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>/div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/body<span class="token operator">&gt;</span><span class="token operator">&lt;</span>/html<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>lxml 可以自动修正 html 代码，例子里不仅补全了 li 标签，还添加了 body，html 标签。</p><h3 id="文件读取" tabindex="-1"><a class="header-anchor" href="#文件读取" aria-hidden="true">#</a> 文件读取</h3><p>除了直接读取字符串，lxml还支持从文件里读取内容。我们新建一个hello.html文件：</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!-- hello.html --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item-0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link1.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>first item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link2.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>second item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item-inactive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link3.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bold<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>third item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item-1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link4.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>fourth item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item-0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link5.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>fifth item<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再利用 etree.parse() 方法来读取文件。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># lxml_parse.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

<span class="token comment"># 读取外部文件 hello.html</span>
html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;./hello.html&#39;</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> etree<span class="token punctuation">.</span>tostring<span class="token punctuation">(</span>html<span class="token punctuation">,</span> pretty_print<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出结果与之前相同：</p><div class="language-ht line-numbers-mode" data-ext="ht"><pre class="language-ht"><code>&lt;html&gt;&lt;body&gt;
&lt;div&gt;
    &lt;ul&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link1.html&quot;&gt;first item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link2.html&quot;&gt;second item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-inactive&quot;&gt;&lt;a href=&quot;link3.html&quot;&gt;third item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-1&quot;&gt;&lt;a href=&quot;link4.html&quot;&gt;fourth item&lt;/a&gt;&lt;/li&gt;
         &lt;li class=&quot;item-0&quot;&gt;&lt;a href=&quot;link5.html&quot;&gt;fifth item&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
 &lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xpath实例测试" tabindex="-1"><a class="header-anchor" href="#xpath实例测试" aria-hidden="true">#</a> XPath实例测试</h3><h4 id="_1-获取所有的-li-标签" tabindex="-1"><a class="header-anchor" href="#_1-获取所有的-li-标签" aria-hidden="true">#</a> 1. 获取所有的 <code>&lt;li&gt;</code> 标签</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token builtin">type</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>  <span class="token comment"># 显示etree.parse() 返回类型</span>

result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> result  <span class="token comment"># 打印&lt;li&gt;标签的元素集合</span>
<span class="token keyword">print</span> <span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token builtin">type</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token builtin">type</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出结果：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>type <span class="token string">&#39;lxml.etree._ElementTree&#39;</span><span class="token operator">&gt;</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span>Element li at 0x1014e0e1<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>, <span class="token operator">&lt;</span>Element li at 0x1014e0ef<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>Element li at 0x1014e0f3<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>, <span class="token operator">&lt;</span>Element li at 0x1014e0f8<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>, <span class="token operator">&lt;</span>Element li at 0x1014e0fc<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token punctuation">]</span>
<span class="token number">5</span>
<span class="token operator">&lt;</span>type <span class="token string">&#39;list&#39;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>type <span class="token string">&#39;lxml.etree._Element&#39;</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-继续获取-li-标签的所有-class属性" tabindex="-1"><a class="header-anchor" href="#_2-继续获取-li-标签的所有-class属性" aria-hidden="true">#</a> 2. 继续获取<code>&lt;li&gt;</code> 标签的所有 <code>class</code>属性\`</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li/@class&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> result
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token string">&#39;item-0&#39;</span>, <span class="token string">&#39;item-1&#39;</span>, <span class="token string">&#39;item-inactive&#39;</span>, <span class="token string">&#39;item-1&#39;</span>, <span class="token string">&#39;item-0&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_3-继续获取-li-标签下hre-为-link1-html-的-a-标签" tabindex="-1"><a class="header-anchor" href="#_3-继续获取-li-标签下hre-为-link1-html-的-a-标签" aria-hidden="true">#</a> 3. 继续获取<code>&lt;li&gt;</code>标签下<code>hre</code> 为 <code>link1.html</code> 的 <code>&lt;a&gt;</code> 标签</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li/a[@href=&quot;link1.html&quot;]&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> result
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token operator">&lt;</span>Element a at 0x10ffaae1<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_4-获取-li-标签下的所有-span-标签" tabindex="-1"><a class="header-anchor" href="#_4-获取-li-标签下的所有-span-标签" aria-hidden="true">#</a> 4. 获取<code>&lt;li&gt;</code> 标签下的所有 <code>&lt;span&gt;</code> 标签</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>

<span class="token comment">#result = html.xpath(&#39;//li/span&#39;)</span>
<span class="token comment">#注意这么写是不对的：</span>
<span class="token comment">#因为 / 是用来获取子元素的，而 &lt;span&gt; 并不是 &lt;li&gt; 的子元素，所以，要用双斜杠</span>

result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li//span&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> result
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token operator">&lt;</span>Element span at 0x10d698e1<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_5-获取-li-标签下的-a-标签里的所有-class" tabindex="-1"><a class="header-anchor" href="#_5-获取-li-标签下的-a-标签里的所有-class" aria-hidden="true">#</a> 5. 获取 <code>&lt;li&gt;</code> 标签下的<code>&lt;a&gt;</code>标签里的所有 class</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li/a//@class&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span> result
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token string">&#39;blod&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_6-获取最后一个-li-的-a-的-href" tabindex="-1"><a class="header-anchor" href="#_6-获取最后一个-li-的-a-的-href" aria-hidden="true">#</a> 6. 获取最后一个 <code>&lt;li&gt;</code> 的 <code>&lt;a&gt;</code> 的 href</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>

result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li[last()]/a/@href&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># 谓语 [last()] 可以找到最后一个元素</span>

<span class="token keyword">print</span> result
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span><span class="token string">&#39;link5.html&#39;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_7-获取倒数第二个元素的内容" tabindex="-1"><a class="header-anchor" href="#_7-获取倒数第二个元素的内容" aria-hidden="true">#</a> 7. 获取倒数第二个元素的内容</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//li[last()-1]/a&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># text 方法可以获取元素内容</span>
<span class="token keyword">print</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>fourth item
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_8-获取-class-值为-bold-的标签名" tabindex="-1"><a class="header-anchor" href="#_8-获取-class-值为-bold-的标签名" aria-hidden="true">#</a> 8. 获取 <code>class</code> 值为 <code>bold</code> 的标签名</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># xpath_li.py</span>

<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

html <span class="token operator">=</span> etree<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">&#39;hello.html&#39;</span><span class="token punctuation">)</span>

result <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//*[@class=&quot;bold&quot;]&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># tag方法可以获取标签名</span>
<span class="token keyword">print</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tag
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行结果:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>span
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="案例-使用xpath的爬虫" tabindex="-1"><a class="header-anchor" href="#案例-使用xpath的爬虫" aria-hidden="true">#</a> 案例：使用XPath的爬虫</h2><p>现在我们用XPath来做一个简单的爬虫，我们尝试爬取某个贴吧里的所有帖子，并且将该这个帖子里每个楼层发布的图片下载到本地。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># tieba_xpath.py</span>

<span class="token comment"># !/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> os
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree


<span class="token keyword">class</span> <span class="token class-name">Spider</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>tiebaName <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;请输入需要访问的贴吧：&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>beginPage <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;请输入起始页：&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>endPage <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;请输入终止页：&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">&#39;http://tieba.baidu.com/f&#39;</span>
        self<span class="token punctuation">.</span>ua_header <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1 Trident/5.0;&quot;</span><span class="token punctuation">}</span>

        <span class="token comment"># 图片编号</span>
        self<span class="token punctuation">.</span>userName <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">tiebaSpider</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>beginPage<span class="token punctuation">,</span> self<span class="token punctuation">.</span>endPage <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            pn <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">50</span>  <span class="token comment"># page number</span>
            word <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;pn&#39;</span><span class="token punctuation">:</span> pn<span class="token punctuation">,</span> <span class="token string">&#39;kw&#39;</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>tiebaName<span class="token punctuation">}</span>

            word <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>word<span class="token punctuation">)</span>  <span class="token comment"># 转换成url编码格式（字符串）</span>
            myUrl <span class="token operator">=</span> self<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">&quot;?&quot;</span> <span class="token operator">+</span> word

            <span class="token comment"># 示例：http://tieba.baidu.com/f? kw=%E7%BE%8E%E5%A5%B3 &amp; pn=50</span>
            <span class="token comment"># 调用 页面处理函数 load_Page</span>
            <span class="token comment"># 并且获取页面所有帖子链接,</span>
            links <span class="token operator">=</span> self<span class="token punctuation">.</span>loadPage<span class="token punctuation">(</span>myUrl<span class="token punctuation">)</span>

    <span class="token comment"># 读取页面内容</span>
    <span class="token keyword">def</span> <span class="token function">loadPage</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
        req <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>self<span class="token punctuation">.</span>ua_header<span class="token punctuation">)</span>
        <span class="token keyword">with</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
            html <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 解析html 为 HTML 文档</span>
        selector <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html<span class="token punctuation">)</span>

        <span class="token comment"># 抓取当前页面的所有帖子的url的后半部分，也就是帖子编号</span>
        <span class="token comment"># http://tieba.baidu.com/p/4884069807里的 “p/4884069807”</span>
        links <span class="token operator">=</span> selector<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//div[@class=&quot;threadlist_lz clearfix&quot;]/div/a/@href&#39;</span><span class="token punctuation">)</span>

        <span class="token comment"># links 类型为 etreeElementString 列表</span>
        <span class="token comment"># 遍历列表，并且合并成一个帖子地址，调用 图片处理函数 loadImage</span>
        <span class="token keyword">for</span> link <span class="token keyword">in</span> links<span class="token punctuation">:</span>
            link <span class="token operator">=</span> <span class="token string">&quot;http://tieba.baidu.com&quot;</span> <span class="token operator">+</span> link
            self<span class="token punctuation">.</span>loadImages<span class="token punctuation">(</span>link<span class="token punctuation">)</span>

    <span class="token comment"># 获取图片</span>
    <span class="token keyword">def</span> <span class="token function">loadImages</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> link<span class="token punctuation">)</span><span class="token punctuation">:</span>
        req <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>link<span class="token punctuation">,</span> headers<span class="token operator">=</span>self<span class="token punctuation">.</span>ua_header<span class="token punctuation">)</span>
        <span class="token keyword">with</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>req<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
            html <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

        selector <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html<span class="token punctuation">)</span>

        <span class="token comment"># 获取这个帖子里所有图片的src路径</span>
        imagesLinks <span class="token operator">=</span> selector<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">&#39;//img[@class=&quot;BDE_Image&quot;]/@src&#39;</span><span class="token punctuation">)</span>

        <span class="token comment"># 依次取出图片路径，下载保存</span>
        <span class="token keyword">for</span> imagesLink <span class="token keyword">in</span> imagesLinks<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>writeImages<span class="token punctuation">(</span>imagesLink<span class="token punctuation">)</span>

    <span class="token comment"># 保存页面内容</span>
    <span class="token keyword">def</span> <span class="token function">writeImages</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> imagesLink<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&#39;&#39;&#39;
            将 images 里的二进制内容存入到 userNname 文件中
        &#39;&#39;&#39;</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>imagesLink<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;正在存储文件 %d ...&quot;</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>userName<span class="token punctuation">)</span>
        <span class="token comment"># 1. 打开文件，返回一个文件对象</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">&#39;./images/&#39;</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        file_path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&#39;./images/</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>userName<span class="token punctuation">}</span></span><span class="token string">.png&#39;</span></span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">&#39;wb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
            <span class="token comment"># 2. 获取图片里的内容</span>
            <span class="token keyword">with</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>imagesLink<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>
                images <span class="token operator">=</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment"># 3. 调用文件对象write() 方法，将page_html的内容写入到文件里</span>
            <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>images<span class="token punctuation">)</span>

        <span class="token comment"># 计数器自增1</span>
        self<span class="token punctuation">.</span>userName <span class="token operator">+=</span> <span class="token number">1</span>


<span class="token comment"># 模拟 main 函数</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># 首先创建爬虫对象</span>
    mySpider <span class="token operator">=</span> Spider<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 调用爬虫对象的方法，开始工作</span>
    mySpider<span class="token punctuation">.</span>tiebaSpider<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>喜欢这篇文章的话，可以关注一下我的公众号『<strong>海哥python</strong>』</p></blockquote>`,50);function L(_,X){const a=o("ExternalLinkIcon");return l(),i("div",null,[d,k,m,n("p",null,[s("W3School官方文档："),n("a",v,[s("http://www.w3school.com.cn/xml/index.asp"),t(a)])]),g,n("blockquote",null,[b,n("p",null,[s("W3School官方文档："),n("a",h,[s("http://www.w3school.com.cn/xpath/index.asp"),t(a)])])]),y,n("blockquote",null,[f,x,n("p",null,[s("lxml python 官方文档："),n("a",q,[s("http://lxml.de/index.html"),t(a)])]),w]),M])}const I=p(u,[["render",L],["__file","8.xpath和lxml类库.html.vue"]]);export{I as default};
