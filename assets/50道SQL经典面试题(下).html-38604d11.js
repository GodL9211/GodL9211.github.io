import{_ as p}from"./plugin-vue_export-helper-c27b6911.js";import{r as e,o as t,c as o,a as n,b as s,e as c,f as l}from"./app-6b5c8e46.js";const i="/assets/image_BQ4yODnMC8-cfb42c91.png",u="/assets/image_5GtjwmQnHz-75999ef2.png",k="/assets/image_lBFF5CsbHq-19d3addb.png",d="/assets/image_7iHKp7GvKN-03d72692.png",r="/assets/image_2b0Z9Tw_Ui-640b9c53.png",v={},m=n("h1",{id:"_50道sql经典面试题-下",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_50道sql经典面试题-下","aria-hidden":"true"},"#"),s(" 50道SQL经典面试题(下)")],-1),b={href:"http://wiznote-desktop/ks/note/view/79a579df-0e97-4971-8f60-86ed3beffd85/92198ca5-d9f0-4d98-ab67-d20f976da33d/index.html?lang=zh-cn&readerType=common&isPersonalKb=1&canEdit=1&userGuid=79a579df-0e97-4971-8f60-86ed3beffd85&alias=godl9211&pSpacing=16&darkBgColor=transparent&darkTextColor=#f0f0f0&isFromWizClipper=1&xssNoFrame=1&themeMode=auto&resourcesPath=&frameKey=normal_note_92198ca5-d9f0-4d98-ab67-d20f976da33d",target:"_blank",rel:"noopener noreferrer"},y=l(`<p>最近在收集SQL每日一题时，找到这套比较经典的SQL面试题。 </p><p>我根据题目重新梳理了一遍，包括表结构，表之间的关系，测试数据，题目，参考答案等。其中大部分参考答案在各种数据库平台上通用。 </p><p>由于题目数量较多（足足50道题），小伙伴们可能不容易消化理解，于是将内容分为上下两篇，希望对你有所帮助。</p><p><strong>一、表结构</strong></p><p>1、学生表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>Student<span class="token punctuation">(</span>Sid<span class="token punctuation">,</span>Sname<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>Ssex<span class="token punctuation">)</span>
学生编号，学生姓名，出生年月，学生性别
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2、课程表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>Course<span class="token punctuation">(</span>Cid<span class="token punctuation">,</span>Cname<span class="token punctuation">,</span>Tid<span class="token punctuation">)</span> 
课程编号，课程名称，教师编号
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>3、教师表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>Teacher<span class="token punctuation">(</span>Tid<span class="token punctuation">,</span>Tname<span class="token punctuation">)</span>
教师编号，教师姓名
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>4、成绩表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>SC<span class="token punctuation">(</span>Sid<span class="token punctuation">,</span>Cid<span class="token punctuation">,</span>Score<span class="token punctuation">)</span>
学生编号，课程编号，分数
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>二、表之间的关系</strong></p><p>四张表之间的关系如下图：</p><figure><img src="`+i+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>我们来解读一下上面的关系： </p><p>1、课程表Course的课程编号(Cid)作为主键，在成绩表(SC)中可以看到一个或多个学生的课程分数，两表之间是属于<code>1：n</code>的关系。同理学生表(Student)与成绩表(SC)也是<code>1：n</code>的关系</p><p>2、教师表Teacher的教师编号(Tid)作为主键，在课程表(Course)中可以带一门或多门课程，两表之间也是属于1：n的关系。</p><p><strong>三、测试数据</strong></p><p>1、学生表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Student <span class="token punctuation">(</span>
  SID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Sname nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Sage <span class="token keyword">datetime</span><span class="token punctuation">,</span>
  Ssex nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;赵雷&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-01-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;钱电&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-12-21&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;孙风&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-05-20&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;李云&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-08-06&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;男&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;05&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;周梅&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1991-12-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;06&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;吴兰&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1992-03-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;07&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;郑竹&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1989-07-01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Student <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;08&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;王菊&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;1990-01-20&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;女&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下：</p><figure><img src="`+u+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>2、课程表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Course <span class="token punctuation">(</span>
  CID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Cname nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  TID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;语文&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;数学&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Course <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;英语&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下： </p><figure><img src="`+k+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>3、教师表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> Teacher <span class="token punctuation">(</span>
  TID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  Tname nvarchar <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;张三&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;李四&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Teacher <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> N<span class="token string">&#39;王五&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下： </p><figure><img src="`+d+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>4、成绩表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--建表语句</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> SC <span class="token punctuation">(</span>
  SID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  CID <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  score <span class="token keyword">DECIMAL</span> <span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment">--插入测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;04&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;05&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;05&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;06&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;01&#39;</span> <span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;06&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;07&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span> <span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> SC <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token string">&#39;07&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span> <span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果如下： </p><figure><img src="`+r+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>四、面试题及参考答案</strong></p><p>26、查询出只选修两门课程的学生学号和姓名 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span>Sname
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> SID <span class="token operator">in</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> SID <span class="token keyword">FROM</span>
  <span class="token punctuation">(</span><span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CID<span class="token punctuation">)</span> 课程数
   <span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID 
  <span class="token punctuation">)</span> A
 <span class="token keyword">WHERE</span> A<span class="token punctuation">.</span>课程数<span class="token operator">=</span><span class="token number">2</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>27、查询男生、女生人数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> Ssex<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>Ssex<span class="token punctuation">)</span> 人数
<span class="token keyword">FROM</span> Student
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Ssex
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>28、查询名字中含有「风」字的学生信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> Sname <span class="token operator">like</span> <span class="token string">&#39;%风%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>29、查询同名同性学生名单，并统计这些人数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>B<span class="token punctuation">.</span>人数
<span class="token keyword">FROM</span> Student A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> Sname<span class="token punctuation">,</span>Ssex<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 人数
<span class="token keyword">FROM</span> Student <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Sname<span class="token punctuation">,</span>Ssex
<span class="token punctuation">)</span> B
<span class="token keyword">ON</span> A<span class="token punctuation">.</span>Sname<span class="token operator">=</span>B<span class="token punctuation">.</span>Sname <span class="token operator">and</span> A<span class="token punctuation">.</span>Ssex<span class="token operator">=</span>B<span class="token punctuation">.</span>Ssex
<span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>人数<span class="token operator">&gt;</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>30、查询 1990 年出生的学生名单</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span>Sage<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1990</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>31、查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 平均成绩
<span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 平均成绩 <span class="token keyword">DESC</span><span class="token punctuation">,</span>CID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>32、查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>A<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>B<span class="token punctuation">.</span>平均成绩
<span class="token keyword">FROM</span> Student A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 平均成绩
<span class="token keyword">FROM</span> SC <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
<span class="token punctuation">)</span> B <span class="token keyword">on</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
<span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>平均成绩<span class="token operator">&gt;</span><span class="token number">85</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>33、查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> B<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>A<span class="token punctuation">.</span>score <span class="token keyword">FROM</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> score<span class="token operator">&lt;</span><span class="token number">60</span> 
<span class="token operator">and</span> CID<span class="token operator">=</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID <span class="token keyword">FROM</span> Course
<span class="token keyword">WHERE</span> Cname<span class="token operator">=</span><span class="token string">&#39;数学&#39;</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span> A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Student B <span class="token keyword">on</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>34、查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>B<span class="token punctuation">.</span>CID<span class="token punctuation">,</span>B<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> Student A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> SC B <span class="token keyword">on</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>35、查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>D<span class="token punctuation">.</span>Cname<span class="token punctuation">,</span>D<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> B<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>C<span class="token punctuation">.</span>Cname
<span class="token keyword">FROM</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> score<span class="token operator">&gt;</span><span class="token number">70</span><span class="token punctuation">)</span> B
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Course C <span class="token keyword">on</span> B<span class="token punctuation">.</span>CID<span class="token operator">=</span>C<span class="token punctuation">.</span>CID
<span class="token punctuation">)</span> D
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Student A <span class="token keyword">on</span> D<span class="token punctuation">.</span>SID<span class="token operator">=</span>A<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>36、查询不及格的课程学生姓名，课程名及分数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> C<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>B<span class="token punctuation">.</span>Cname<span class="token punctuation">,</span>A<span class="token punctuation">.</span>score <span class="token keyword">FROM</span> SC A
<span class="token keyword">JOIN</span> Course B <span class="token keyword">ON</span> A<span class="token punctuation">.</span>CID<span class="token operator">=</span>B<span class="token punctuation">.</span>CID
<span class="token keyword">JOIN</span> Student C <span class="token keyword">ON</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>C<span class="token punctuation">.</span>SID
<span class="token keyword">WHERE</span> A<span class="token punctuation">.</span>score<span class="token operator">&lt;</span><span class="token number">60</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>37、查询课程编号为01且课程成绩在80分以上的学生的学号和姓名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> A<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>B<span class="token punctuation">.</span>Sname
<span class="token keyword">FROM</span> 
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> score<span class="token operator">&gt;</span><span class="token number">80</span> <span class="token operator">and</span> CID<span class="token operator">=</span><span class="token string">&#39;01&#39;</span>
<span class="token punctuation">)</span> A
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Student B <span class="token keyword">on</span> A<span class="token punctuation">.</span>SID<span class="token operator">=</span>B<span class="token punctuation">.</span>SID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>38、求每门课程的学生人数（假设每个学生都有参加考试且有成绩）</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 学生人数
<span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>39、成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">TOP</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CID<span class="token operator">=</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> CID
<span class="token keyword">FROM</span> Course
<span class="token keyword">WHERE</span> TID<span class="token operator">=</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> TID <span class="token keyword">FROM</span> Teacher
<span class="token keyword">WHERE</span> Tname<span class="token operator">=</span><span class="token string">&#39;张三&#39;</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>40、成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> 
<span class="token punctuation">(</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>DENSE_RANK<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">OVER</span><span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span> A
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CID<span class="token operator">=</span>
<span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> CID <span class="token keyword">FROM</span> Course
<span class="token keyword">WHERE</span> TID<span class="token operator">=</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> TID <span class="token keyword">FROM</span> Teacher
<span class="token keyword">WHERE</span> Tname<span class="token operator">=</span><span class="token string">&#39;张三&#39;</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>B
<span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>A<span class="token operator">=</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>41、查询每门功成绩最好的前两名</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>ROW_NUMBER<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">OVER</span> <span class="token punctuation">(</span><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> CID <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span>A
<span class="token keyword">FROM</span> SC
<span class="token punctuation">)</span>B
<span class="token keyword">WHERE</span> B<span class="token punctuation">.</span>A<span class="token operator">&lt;</span><span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>42、统计每门课程的学生选修人数（超过5人的课程才统计），要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> CID<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>SID<span class="token punctuation">)</span> 选修人数
<span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CID
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>SID<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">5</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 选修人数 <span class="token keyword">DESC</span><span class="token punctuation">,</span>CID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>43、检索至少选修两门课程的学生学号 </p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SID <span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>CID<span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>44、查询选修了全部课程的学生信息</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SID <span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SID 
<span class="token keyword">HAVING</span>  <span class="token function">COUNT</span><span class="token punctuation">(</span>CID<span class="token punctuation">)</span><span class="token operator">=</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> a
<span class="token keyword">FROM</span> Course<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>45、查询各学生的年龄，只按年份来算</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> SID<span class="token punctuation">,</span>DATEDIFF<span class="token punctuation">(</span><span class="token keyword">Year</span><span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 年龄
<span class="token keyword">FROM</span> Student
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>46、按照出生日期来算，当前月日小于出生日期的月日则年龄减1岁</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span>  
<span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token string">&#39;1&#39;</span><span class="token operator">+</span>SUBSTRING<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sage<span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token operator">&lt;</span> <span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token string">&#39;1&#39;</span><span class="token operator">+</span>SUBSTRING<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">THEN</span> DATEDIFF<span class="token punctuation">(</span>YY<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">ELSE</span> DATEDIFF<span class="token punctuation">(</span>YY<span class="token punctuation">,</span>Sage<span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span> 
<span class="token keyword">END</span>
<span class="token punctuation">)</span>age
<span class="token keyword">FROM</span> Student
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>47、查询本周过生日的学生</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
<span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> DATENAME<span class="token punctuation">(</span>wk<span class="token punctuation">,</span><span class="token keyword">CONVERT</span>
<span class="token punctuation">(</span><span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">+</span>SUBSTRING<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sage<span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">=</span>DATENAME<span class="token punctuation">(</span>WK<span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span>
<span class="token punctuation">)</span> 生日提醒
<span class="token keyword">FROM</span> Student
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>48、查询下周过生日的学生</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
<span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> DATENAME<span class="token punctuation">(</span>wk<span class="token punctuation">,</span><span class="token keyword">CONVERT</span>
<span class="token punctuation">(</span><span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">+</span>SUBSTRING<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sage<span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">=</span>DATENAME<span class="token punctuation">(</span>WK<span class="token punctuation">,</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>
<span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span>
<span class="token punctuation">)</span> 生日提醒
<span class="token keyword">FROM</span> Student
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>49、查询本月过生日的学生</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
<span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>
<span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">+</span>SUBSTRING<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sage<span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">=</span><span class="token keyword">MONTH</span><span class="token punctuation">(</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">THEN</span> <span class="token number">1</span> <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span> 生日提醒
<span class="token keyword">FROM</span> Student
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>50、查询下月过生日的学生</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token punctuation">(</span>
<span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>
<span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">DATETIME</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">+</span>SUBSTRING<span class="token punctuation">(</span><span class="token keyword">CONVERT</span><span class="token punctuation">(</span><span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Sage<span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">=</span><span class="token keyword">MONTH</span><span class="token punctuation">(</span>GETDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>
<span class="token keyword">then</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">end</span><span class="token punctuation">)</span>生日提醒
<span class="token keyword">FROM</span> Student
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上就是50道经典SQL面试题的全部内容</p>`,87);function w(E,g){const a=e("ExternalLinkIcon");return t(),o("div",null,[m,n("p",null,[s("原创 丶平凡世界 "),n("a",b,[s("SQL数据库开发"),c(a)])]),y])}const C=p(v,[["render",w],["__file","50道SQL经典面试题(下).html.vue"]]);export{C as default};
